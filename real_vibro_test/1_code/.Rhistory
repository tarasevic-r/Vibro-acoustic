size = dw/2^(u-1)
while((size/2) > max_fr) {
u = u+1
size = dw/2^(u-1)
}
u=u-1
if(u==2){
u=u+1
}
#for vibration u=u+4
u = u+4
size = dw/2^(u-1)
cat(" Highest dominant harmonic: ", max_fr, '\n',
"Wavelet decomposition level: ", (u-1), '\n',
"Wavelet sub-bands number: ", 2^(u-1), '\n',
"Sub-band size: ", size, '\n',
"Data window size: ", dw, '\n',
"Slide: ", slide)
par(mfrow=c(1,1))
# set data window parameters
n=11 #15
from = 1
to = 2^n
dw = 2^n
slide = dw/2
s = s_orig[1:dw]
plot(Mod(fft(s)), type = 'h',xlim=c(0,dw/2))
quant <- quantile(Mod(fft(s)[1:1024]), 0.95)
max_fr = max(which(Mod(fft(s)[1:512]) > quant))
u=1
size = dw/2^(u-1)
while((size/2) > max_fr) {
u = u+1
size = dw/2^(u-1)
}
u=u-1
if(u==2){
u=u+1
}
#for vibration u=u+4
u = u+3
size = dw/2^(u-1)
cat(" Highest dominant harmonic: ", max_fr, '\n',
"Wavelet decomposition level: ", (u-1), '\n',
"Wavelet sub-bands number: ", 2^(u-1), '\n',
"Sub-band size: ", size, '\n',
"Data window size: ", dw, '\n',
"Slide: ", slide)
par(mfrow=c(1,1))
# set data window parameters
n=11 #15
from = 1
to = 2^n
dw = 2^n
slide = dw/2
s = s_orig[1:dw]
plot(Mod(fft(s)), type = 'h',xlim=c(0,dw/2))
quant <- quantile(Mod(fft(s)[1:1024]), 0.95)
max_fr = max(which(Mod(fft(s)[1:512]) > quant))
u=1
size = dw/2^(u-1)
while((size/2) > max_fr) {
u = u+1
size = dw/2^(u-1)
}
u=u-1
if(u==2){
u=u+1
}
#for vibration u=u+4
u = u+4
size = dw/2^(u-1)
cat(" Highest dominant harmonic: ", max_fr, '\n',
"Wavelet decomposition level: ", (u-1), '\n',
"Wavelet sub-bands number: ", 2^(u-1), '\n',
"Sub-band size: ", size, '\n',
"Data window size: ", dw, '\n',
"Slide: ", slide)
# calculate wavelet decomposition energy (u-th level)
source("energy_calculation.R")
# cluster sub-band energy
source("sub-band_energy_clustering.R")
# mean category calculation
source("Mean_category.R")
# Final clustering results
source("energy_classification.R")
#### LOAD DATA ####
#read wav file
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/akmenys.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
#### WAVELET PARAMETERS ####
# select wavelet decomposition level
vibration = F # set T for vibration data
source("wavelet_parameters_selection.R")
#### ENERGY CALCULATION ####
# calculate wavelet decomposition energy (u-th level)
source("energy_calculation.R")
# cluster sub-band energy
source("sub-band_energy_clustering.R")
# mean category calculation
source("Mean_category.R")
#### CLUSTERING ####
# Final clustering results
source("energy_classification.R")
name = "../../data/audio/chainsaw.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
# load user functions
source("user-functions.R")
#### WAVELET PARAMETERS ####
# select wavelet decomposition level
vibration = F # set T for vibration data
source("wavelet_parameters_selection.R")
#### ENERGY CALCULATION ####
# calculate wavelet decomposition energy (u-th level)
source("energy_calculation.R")
n=11 #15
from = 1
to = 2^n
dw = 2^n
slide = dw/2
s = s_orig[1:dw]
plot(Mod(fft(s)), type = 'h',xlim=c(0,dw/2))
quant <- quantile(Mod(fft(s)[1:1024]), 0.95)
max_fr = max(which(Mod(fft(s)[1:512]) > quant))
u=1
size = dw/2^(u-1)
while((size/2) > max_fr) {
u = u+1
size = dw/2^(u-1)
}
u=u-1
if(u==2){
u=u+1
}
cat(" Highest dominant harmonic: ", max_fr, '\n',
"Wavelet decomposition level: ", (u-1), '\n',
"Wavelet sub-bands number: ", 2^(u-1), '\n',
"Sub-band size: ", size, '\n',
"Data window size: ", dw, '\n',
"Slide: ", slide)
#for vibration u=u+4
if(vibration ==T){
u = u+4
size = dw/2^(u-1)
}
cat(" Highest dominant harmonic: ", max_fr, '\n',
"Wavelet decomposition level: ", (u-1), '\n',
"Wavelet sub-bands number: ", 2^(u-1), '\n',
"Sub-band size: ", size, '\n',
"Data window size: ", dw, '\n',
"Slide: ", slide)
# cluster sub-band energy
source("sub-band_energy_clustering.R")
# mean category calculation
source("Mean_category.R")
#### CLUSTERING ####
# Final clustering results
source("energy_classification.R")
rm(list=ls())
#### LOAD DATA ####
#read wav file
vibration = F # set T for vibration data
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/chainsaw.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
# read vibration data
source("read_vibro.R")
rm(list=ls())
#### LOAD DATA ####
#read wav file
vibration = F # set T for vibration data
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/chainsaw.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
# load user functions
source("user-functions.R")
# load user functions
source("user-functions.R")
rm(list=ls())
#### LOAD DATA ####
#read wav file
vibration = F # set T for vibration data
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/chainsaw.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
# load user functions
source("user-functions.R")
# User functions:
source("features_function.R")
rm(list=ls())
#### LOAD DATA ####
#read wav file
vibration = F # set T for vibration data
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/chainsaw.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
# load user functions
source("user-functions.R")
rm(list=ls())
# load user functions
source("user-functions.R")
#read wav file
vibration = F # set T for vibration data
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/chainsaw.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
#### WAVELET PARAMETERS ####
# select wavelet decomposition level
source("wavelet_parameters_selection.R")
cat('\n', 'categories saved as categor.csv', '\n'
, "sub-band energy clustering DONE!")
cat('\n', 'categories saved as categor.csv', '\n',
"------------------------", '\n'
, "sub-band energy clustering DONE!")
cat('\n', 'categories saved as categor.csv', '\n',
"---------------------------", '\n'
, "sub-band energy clustering DONE!")
cat('\n', 'categories saved as categor.csv', '\n',
"-------------------------", '\n'
, "sub-band energy clustering DONE!")
cat('\n', 'categories saved as categor.csv', '\n',
"----------------------------", '\n'
, "sub-band energy clustering DONE!")
cat('\n', 'categories saved as categor.csv', '\n',
"----------------------------------", '\n'
, "sub-band energy clustering DONE!")
cat('\n', 'categories saved as categor.csv', '\n',
"--------------------------------", '\n'
, "sub-band energy clustering DONE!")
# calculate "mean" category value of one energy subset
mean_cat = round(colMeans(categor),2)
mean_cat = scale(as.data.frame(mean_cat))
plot(mean_cat, type = 'h', ylab="mean category", main = "Mean category over slide")
#### CLUSTERING ####
# Final clustering results
source("energy_classification.R")
#read wav file
vibration = F # set T for vibration data
# load user functions
source("user-functions.R")
#read wav file
vibration = F # set T for vibration data
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/graztas.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
#### WAVELET PARAMETERS ####
# select wavelet decomposition level
source("wavelet_parameters_selection.R")
#### ENERGY CALCULATION ####
# calculate wavelet decomposition energy (u-th level)
source("energy_calculation.R")
cat('\n', 'energies saved as energy.csv',
'--------------------------------','\n'
'\n', "sub-band energy calculatoin DONE!")
cat('\n', 'energies saved as energy.csv',
'--------------------------------','\n',
'\n', "sub-band energy calculatoin DONE!")
cat('\n', 'energies saved as energy.csv',
'\n','--------------------------------',
'\n', "sub-band energy calculatoin DONE!")
cat('\n', 'energies saved as energy.csv',
'\n','------------------------------',
'\n', "sub-band energy calculatoin DONE!")
cat('\n', 'energies saved as energy.csv',
'\n','-------------------------------',
'\n', "sub-band energy calculatoin DONE!")
cat('\n', 'energies saved as energy.csv',
'\n','--------------------------------',
'\n', "sub-band energy calculatoin DONE!")
# cluster sub-band energy
source("sub-band_energy_clustering.R")
# mean category calculation
source("Mean_category.R")
#### CLUSTERING ####
# Final clustering results
source("energy_classification.R")
rm(list=ls())
# load user functions
source("user-functions.R")
#read wav file
vibration = T # set T for vibration data
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/graztas.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
#### WAVELET PARAMETERS ####
# select wavelet decomposition level
source("wavelet_parameters_selection.R")
#### ENERGY CALCULATION ####
# calculate wavelet decomposition energy (u-th level)
source("energy_calculation.R")
# cluster sub-band energy
source("sub-band_energy_clustering.R")
# mean category calculation
source("Mean_category.R")
#### CLUSTERING ####
# Final clustering results
source("energy_classification.R")
### 1
# d1 = rmatio::read.mat("../../data/VIBRO/data 1/healthy/H-A-1.mat")
# d2 = rmatio::read.mat("../../data/VIBRO/data 1/healthy/H-B-1.mat")
### 2
# d1 = rmatio::read.mat("../../data/VIBRO/data 1/faulty/B-A-2.mat")
# d2 = rmatio::read.mat("../../data/VIBRO/data 1/faulty/B-B-2.mat")
### 3
d1 = rmatio::read.mat("../../data/VIBRO/data 1/faulty/B-C-1.mat")
d2 = rmatio::read.mat("../../data/VIBRO/data 1/healthy/H-A-1.mat")
d2
d1
#read wav file
vibration = T # set T for vibration data
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/graztas.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
#### WAVELET PARAMETERS ####
# select wavelet decomposition level
source("wavelet_parameters_selection.R")
#### ENERGY CALCULATION ####
# calculate wavelet decomposition energy (u-th level)
source("energy_calculation.R")
# cluster sub-band energy
source("sub-band_energy_clustering.R")
getwd()
data = read.csv("../../../../Downloads/gen_le1.xlsx")
plot.ts(data$PK...)
plot.ts(data[,1])
plot.ts(data[,2])
plot.ts(data[1,])
data = read.csv("../../../../Downloads/gen_le1.xlsx", header = T)
data = read.csv("../../../../Downloads/gen_le1.xlsx", header = T, sep = ',')
plot.ts(data[,1])
data
# mean category calculation
source("Mean_category.R")
#### CLUSTERING ####
# Final clustering results
source("energy_classification.R")
rm(list=ls())
# load user functions
source("user-functions.R")
#read wav file
vibration = T # set T for vibration data
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/graztas.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
#### WAVELET PARAMETERS ####
# select wavelet decomposition level
source("wavelet_parameters_selection.R")
#### ENERGY CALCULATION ####
# calculate wavelet decomposition energy (u-th level)
source("energy_calculation.R")
# cluster sub-band energy
source("sub-band_energy_clustering.R")
# mean category calculation
source("Mean_category.R")
#### CLUSTERING ####
# Final clustering results
source("energy_classification.R")
rm(list=ls())
# load user functions
source("user-functions.R")
#read wav file
vibration = T # set T for vibration data
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/graztas.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
#### WAVELET PARAMETERS ####
# select wavelet decomposition level
source("wavelet_parameters_selection.R")
#### ENERGY CALCULATION ####
# calculate wavelet decomposition energy (u-th level)
source("energy_calculation.R")
# cluster sub-band energy
source("sub-band_energy_clustering.R")
# cluster sub-band energy
source("sub-band_energy_clustering.R")
# mean category calculation
source("Mean_category.R")
#### CLUSTERING ####
# Final clustering results
source("energy_classification.R")
#### classify categories by mean value ####
# perform classification of average energy categories
result <- LPCM::ms(
mean_cat,
scaled=1,
h=0.04,
plotms=-1)
# assignment (labels)
LPCM_assignment <- result$cluster.label
# value
LPCM_value <- result$cluster.center[LPCM_assignment,]
# set labels for training data
data <- cbind(mean_cat, LPCM_assignment)
colnames(data) <- c("value", "label")
rownames(data) = NULL
data = as.data.frame(data)
Sys.sleep(0.5)
# plot data
x11()
par(mfrow=c(2,1))
plot.ts(s_orig, ylab = "value", main = "Original signal")
plot(data$label, col = data$label, lwd =2, pch=data$label
, ylab = NULL, main = "Clustered signal")
cat('', length(unique(data$label)), "categories found", '\n',
"signal clustering DONE!")
#### classify categories by mean value ####
# perform classification of average energy categories
result <- LPCM::ms(
mean_cat,
scaled=1,
h=0.037,
plotms=-1)
# assignment (labels)
LPCM_assignment <- result$cluster.label
# value
LPCM_value <- result$cluster.center[LPCM_assignment,]
# set labels for training data
data <- cbind(mean_cat, LPCM_assignment)
colnames(data) <- c("value", "label")
rownames(data) = NULL
data = as.data.frame(data)
Sys.sleep(0.5)
# plot data
x11()
par(mfrow=c(2,1))
plot.ts(s_orig, ylab = "value", main = "Original signal")
plot(data$label, col = data$label, lwd =2, pch=data$label
, ylab = NULL, main = "Clustered signal")
cat('', length(unique(data$label)), "categories found", '\n',
"signal clustering DONE!")
#### classify categories by mean value ####
# perform classification of average energy categories
result <- LPCM::ms(
mean_cat,
scaled=1,
h=0.038,
plotms=-1)
# assignment (labels)
LPCM_assignment <- result$cluster.label
# value
LPCM_value <- result$cluster.center[LPCM_assignment,]
# set labels for training data
data <- cbind(mean_cat, LPCM_assignment)
colnames(data) <- c("value", "label")
rownames(data) = NULL
data = as.data.frame(data)
Sys.sleep(0.5)
# plot data
x11()
par(mfrow=c(2,1))
plot.ts(s_orig, ylab = "value", main = "Original signal")
plot(data$label, col = data$label, lwd =2, pch=data$label
, ylab = NULL, main = "Clustered signal")
cat('', length(unique(data$label)), "categories found", '\n',
"signal clustering DONE!")
#### classify categories by mean value ####
# perform classification of average energy categories
result <- LPCM::ms(
mean_cat,
scaled=1,
h=0.039,
plotms=-1)
# assignment (labels)
LPCM_assignment <- result$cluster.label
# value
LPCM_value <- result$cluster.center[LPCM_assignment,]
# set labels for training data
data <- cbind(mean_cat, LPCM_assignment)
colnames(data) <- c("value", "label")
rownames(data) = NULL
data = as.data.frame(data)
Sys.sleep(0.5)
# plot data
x11()
par(mfrow=c(2,1))
plot.ts(s_orig, ylab = "value", main = "Original signal")
plot(data$label, col = data$label, lwd =2, pch=data$label
, ylab = NULL, main = "Clustered signal")
cat('', length(unique(data$label)), "categories found", '\n',
"signal clustering DONE!")
#read wav file
vibration = T # set T for vibration data
audio = "signal_1" # change "signal_1" to save different graphs
name = "../../data/audio/graztas.wav" # audio signal name
graph = FALSE # plot original signal? TRUE/FALSE
source('read_audio.R')
#### WAVELET PARAMETERS ####
# select wavelet decomposition level
source("wavelet_parameters_selection.R")
#### ENERGY CALCULATION ####
# calculate wavelet decomposition energy (u-th level)
source("energy_calculation.R")
# cluster sub-band energy
source("sub-band_energy_clustering.R")
# mean category calculation
source("Mean_category.R")
#### CLUSTERING ####
# Final clustering results
source("energy_classification.R")
